<script>
    /*
    written by dstarr 
    */

    var camera, scene, renderer, animmesh;
    var clock = new THREE.Clock();

    function init() { 
        camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
        camera.position.z = 5;
        scene = new THREE.Scene();
        scene.fog = new THREE.Fog( 0xffffff, 2000, 10000 );
        scene.add(camera);
        //var ground = new THREE.Mesh( geometry, material );
        //ground.position.set( 0, FLOOR, 0 );
        //ground.rotation.x = -Math.PI/2;
        //scene.add( ground );
        //ground.receiveShadow = true;
        var ambient = new THREE.AmbientLight( 0x222222 );
        scene.add( ambient );

        renderer = new THREE.WebGLRenderer( { antialias: true } );
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );
        //container.appendChild( renderer.domElement );
        //stats code, like new Stats();

        var loader = new THREE.JSONLoader();

        loader.load("../../assets/model-threejs.json", function (model, material) {
            console.log('hiiii model: ');
            console.log(model);
            console.log('hiiii loaded material: ');
            console.log(material);

            createScene(model, material);
        });
    }

    function createScene(model, material) {
        //skinning = true for every material;
        material[0].skinning = true;
        animmesh = new THREE.SkinnedMesh(model, material[0]);
        //animmesh.translateY(-2);
        scene.add(animmesh);
        var animation = new THREE.Animation(animmesh, model.animation);
        animation.play();
    }

    function animate() {
        requestAnimationFrame(animate);
        render();
    }

    function render() {
        var delta = 0.75 * clock.getDelta();

        //camera.position.x += ( mouseX - camera.position.x ) * .05;
        //camera.position.y = THREE.Math.clamp( camera.position.y + ( - mouseY - camera.position.y ) * .05, 0, 1000 );
        //camera.lookAt(scene.position);

        if (animmesh) {
            THREE.AnimationHandler.update(delta);
        }

        renderer.render(scene, camera);
    }

    init();
    animate();

</script>
